import{a as B,e as T,r as u,j as e,P as Q,z as m}from"./index-B5aJpQwO.js";import{u as R}from"./useQuery-DiLk-DaS.js";import{u as A}from"./useMutation-CDmglRiW.js";import{u as U}from"./index.esm-BA58FhFx.js";import{t as H,o as O,s as w}from"./types-7h59Fkfz.js";import{h}from"./api-DOR-wefx.js";import{L as P,C as X,a as L,U as K,A as V}from"./Card-BgyJxnnv.js";import{B as $,S as G}from"./Badge-Bb7NU6h0.js";import{E as J}from"./EmptyState-idfWPYnV.js";import{M as W,C as Y}from"./Modal-B6DbCECy.js";import{I as x}from"./Input-DSy_cLET.js";import{c as Z,B as i}from"./Button-CiOENXfr.js";import{P as k}from"./plus-DsVY0QKG.js";import{S as _}from"./search-DCZalx11.js";import{S as D}from"./shield-jL7mq--s.js";import{P as ee}from"./phone-BAkRmmYQ.js";import"./user-DVTd2ZHA.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=Z("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),ae=O({name:w().min(2,"Name is required"),phone:w().min(10,"Valid phone required")});function ve(){var v,N,M;const{userData:r}=B(),p=T(),[E,t]=u.useState(!1),[a,l]=u.useState(null),[o,F]=u.useState(""),n=r==null?void 0:r.houseId,{register:f,handleSubmit:q,reset:c,formState:{errors:j}}=U({resolver:H(ae)}),{data:d,isLoading:z}=R({queryKey:["houseMembers",n],queryFn:()=>h.getMembers(n),enabled:!!n}),y=A({mutationFn:s=>h.addMember(n,s),onSuccess:()=>{m.success("Member added successfully!"),t(!1),c(),p.invalidateQueries(["houseMembers"])},onError:s=>{m.error(s.message||"Failed to add member")}}),g=A({mutationFn:s=>h.removeMember(n,s),onSuccess:()=>{m.success("Member removed"),l(null),p.invalidateQueries(["houseMembers"])},onError:s=>{m.error(s.message||"Failed to remove member")}}),b=(((v=d==null?void 0:d.data)==null?void 0:v.members)||[]).filter(s=>{var S,C;return((S=s.name)==null?void 0:S.toLowerCase().includes(o.toLowerCase()))||((C=s.phone)==null?void 0:C.includes(o))}),I=s=>{y.mutate(s)};return z?e.jsx(P,{children:e.jsx(Q,{})}):e.jsxs(P,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-secondary-900",children:"House Members"}),e.jsx("p",{className:"text-secondary-600 mt-1",children:"Manage members in your house"})]}),e.jsxs(i,{onClick:()=>t(!0),children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Add Member"]})]}),e.jsx(X,{children:e.jsx(L,{className:"p-4",children:e.jsx(x,{placeholder:"Search members...",value:o,onChange:s=>F(s.target.value),leftIcon:e.jsx(_,{className:"h-5 w-5"})})})}),b.length===0?e.jsx(J,{icon:K,title:"No Members Found",description:o?"No members match your search":"Add members to your house to start ordering food together",action:!o&&e.jsxs(i,{onClick:()=>t(!0),children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Add Member"]})}):e.jsx("div",{className:"space-y-3",children:b.map(s=>e.jsx(X,{children:e.jsx(L,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(V,{name:s.name,size:"lg"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold text-secondary-900",children:s.name}),s.isAdmin&&e.jsxs($,{variant:"primary",size:"sm",children:[e.jsx(D,{className:"h-3 w-3 mr-1"}),"Admin"]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-secondary-500",children:[e.jsx(ee,{className:"h-4 w-4"}),s.phone]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(G,{status:s.status||"active"}),!s.isAdmin&&s.id!==(r==null?void 0:r.id)&&e.jsx(i,{variant:"outline",size:"sm",className:"text-danger-600 hover:bg-danger-50",onClick:()=>l(s),children:e.jsx(se,{className:"h-4 w-4"})})]})]})})},s.id))})]}),e.jsx(W,{isOpen:E,onClose:()=>{t(!1),c()},title:"Add Member",size:"sm",children:e.jsxs("form",{onSubmit:q(I),className:"space-y-4",children:[e.jsx(x,{label:"Name",placeholder:"Enter member's name",error:(N=j.name)==null?void 0:N.message,...f("name")}),e.jsx(x,{label:"Phone Number",placeholder:"+91 XXXXX XXXXX",error:(M=j.phone)==null?void 0:M.message,...f("phone")}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(i,{type:"button",variant:"secondary",className:"flex-1",onClick:()=>{t(!1),c()},children:"Cancel"}),e.jsx(i,{type:"submit",className:"flex-1",isLoading:y.isPending,children:"Add Member"})]})]})}),e.jsx(Y,{isOpen:!!a,onClose:()=>l(null),onConfirm:()=>g.mutate(a==null?void 0:a.id),title:"Remove Member",message:`Are you sure you want to remove ${a==null?void 0:a.name} from the house?`,confirmText:"Remove",variant:"danger",isLoading:g.isPending})]})}export{ve as default};

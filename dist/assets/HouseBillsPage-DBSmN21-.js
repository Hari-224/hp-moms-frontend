import{a as B,r as f,j as e,P as w,f as a,b as n}from"./index-B5aJpQwO.js";import{u as C}from"./useQuery-DiLk-DaS.js";import{b as S}from"./api-DOR-wefx.js";import{L as g,C as l,a as r,R as v}from"./Card-BgyJxnnv.js";import{S as h}from"./Badge-Bb7NU6h0.js";import{E}from"./EmptyState-idfWPYnV.js";import{M as P}from"./Modal-B6DbCECy.js";import{B as H}from"./Button-CiOENXfr.js";import{C as L}from"./calendar-CwUE91eJ.js";import{E as k}from"./eye-BawcbnTh.js";import"./user-DVTd2ZHA.js";function K(){var u,y,N;const{userData:c}=B(),[t,j]=f.useState(null),[i,b]=f.useState(""),o=c==null?void 0:c.houseId,{data:x,isLoading:A}=C({queryKey:["houseBills",o,i],queryFn:()=>S.getHouseBills(o,{status:i||void 0}),enabled:!!o}),m=((u=x==null?void 0:x.data)==null?void 0:u.bills)||[],p=m.reduce((s,d)=>(s.total+=d.totalAmount||0,s.paid+=d.paidAmount||0,s.pending+=(d.totalAmount||0)-(d.paidAmount||0),s),{total:0,paid:0,pending:0});return A?e.jsx(g,{children:e.jsx(w,{})}):e.jsxs(g,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-secondary-900",children:"House Bills"}),e.jsx("p",{className:"text-secondary-600 mt-1",children:"View and track bills for your house"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(l,{children:e.jsxs(r,{className:"p-4 text-center",children:[e.jsx("p",{className:"text-sm text-secondary-500",children:"Total Billed"}),e.jsx("p",{className:"text-2xl font-bold text-secondary-900",children:a(p.total)})]})}),e.jsx(l,{children:e.jsxs(r,{className:"p-4 text-center",children:[e.jsx("p",{className:"text-sm text-secondary-500",children:"Paid"}),e.jsx("p",{className:"text-2xl font-bold text-success-600",children:a(p.paid)})]})}),e.jsx(l,{children:e.jsxs(r,{className:"p-4 text-center",children:[e.jsx("p",{className:"text-sm text-secondary-500",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold text-danger-600",children:a(p.pending)})]})})]}),e.jsx(l,{children:e.jsx(r,{className:"p-4",children:e.jsx("div",{className:"flex gap-2",children:["","issued","partial","paid","overdue"].map(s=>e.jsx("button",{onClick:()=>b(s),className:`px-4 py-2 rounded-lg font-medium transition-colors ${i===s?"bg-primary-600 text-white":"bg-secondary-100 text-secondary-700 hover:bg-secondary-200"}`,children:s===""?"All":s.charAt(0).toUpperCase()+s.slice(1)},s))})})}),m.length===0?e.jsx(E,{icon:v,title:"No Bills Found",description:"You don't have any bills yet"}):e.jsx("div",{className:"space-y-4",children:m.map(s=>e.jsx(l,{children:e.jsx(r,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-primary-50 rounded-lg",children:e.jsx(v,{className:"h-6 w-6 text-primary-600"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-secondary-900",children:["Bill #",s.id.slice(-6).toUpperCase()]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-secondary-500",children:[e.jsx(L,{className:"h-4 w-4"}),n(s.periodStart)," - ",n(s.periodEnd)]})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-secondary-500",children:"Total"}),e.jsx("p",{className:"text-lg font-bold text-secondary-900",children:a(s.totalAmount)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-secondary-500",children:"Balance"}),e.jsx("p",{className:"text-lg font-semibold text-danger-600",children:a((s.totalAmount||0)-(s.paidAmount||0))})]}),e.jsx(h,{status:s.status}),e.jsxs(H,{variant:"outline",size:"sm",onClick:()=>j(s),children:[e.jsx(k,{className:"h-4 w-4 mr-1"}),"View"]})]})]})})},s.id))})]}),e.jsx(P,{isOpen:!!t,onClose:()=>j(null),title:"Bill Details",size:"lg",children:t&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-secondary-500",children:"Bill ID"}),e.jsxs("p",{className:"font-medium font-mono",children:["#",t.id.slice(-6).toUpperCase()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-secondary-500",children:"Period"}),e.jsxs("p",{className:"font-medium",children:[n(t.periodStart)," - ",n(t.periodEnd)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-secondary-500",children:"Status"}),e.jsx(h,{status:t.status})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-secondary-500",children:"Agency"}),e.jsx("p",{className:"font-medium",children:t.agencyName})]})]}),e.jsxs("div",{className:"border-t border-secondary-200 pt-4",children:[e.jsx("h4",{className:"font-medium text-secondary-900 mb-3",children:"Order Details"}),e.jsx("div",{className:"bg-secondary-50 rounded-lg p-3 max-h-60 overflow-y-auto",children:((y=t.items)==null?void 0:y.map((s,d)=>e.jsxs("div",{className:"flex justify-between py-2 text-sm border-b border-secondary-100 last:border-0",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-secondary-900",children:s.name}),e.jsxs("span",{className:"text-secondary-500",children:[" Ã— ",s.quantity]}),e.jsxs("span",{className:"text-secondary-400 text-xs ml-2",children:["(",n(s.date),")"]})]}),e.jsx("span",{className:"font-medium text-secondary-900",children:a(s.total)})]},d)))||e.jsx("p",{className:"text-secondary-500 text-center py-4",children:"No items"})})]}),e.jsxs("div",{className:"border-t border-secondary-200 pt-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-secondary-500",children:"Total Amount"}),e.jsx("span",{className:"font-semibold",children:a(t.totalAmount)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-secondary-500",children:"Paid Amount"}),e.jsx("span",{className:"text-success-600 font-medium",children:a(t.paidAmount||0)})]}),e.jsxs("div",{className:"flex justify-between text-lg pt-2 border-t border-secondary-200",children:[e.jsx("span",{className:"font-semibold",children:"Balance Due"}),e.jsx("span",{className:"font-bold text-danger-600",children:a((t.totalAmount||0)-(t.paidAmount||0))})]})]}),((N=t.payments)==null?void 0:N.length)>0&&e.jsxs("div",{className:"border-t border-secondary-200 pt-4",children:[e.jsx("h4",{className:"font-medium text-secondary-900 mb-3",children:"Payment History"}),e.jsx("div",{className:"space-y-2",children:t.payments.map((s,d)=>e.jsxs("div",{className:"flex justify-between items-center py-2 bg-secondary-50 px-3 rounded",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:a(s.amount)}),e.jsx("span",{className:"text-secondary-500 text-sm ml-2",children:n(s.date)})]}),e.jsx(h,{status:s.status})]},d))})]})]})})]})}export{K as default};
